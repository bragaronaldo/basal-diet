<app-header></app-header>

<div class="card flex justify-content-center">
  <p-dialog header="Nova Refeição" [(visible)]="visible" [draggable]="false" [resizable]="false" [modal]="true">
    <div class="my-1 gap-4 flex justify-content-center flex-column">
      <input type="text" placeholder="ex: Almoço" [(ngModel)]="newMeal">
      <button class="btn" (click)="addNewTable()">Criar</button>
    </div>
  </p-dialog>
</div>

<div class="card flex justify-content-center">
  <p-dialog header="Novo Alimento" [(visible)]="visibleNewFood" [draggable]="false" [resizable]="false" [modal]="true">
    <div class="modal-inputs">
      <label for="alimento">Alimento</label>
      <input type="text" id="alimento" name="alimento" [(ngModel)]="foodName" placeholder="ex: Arroz branco cozido">
      <label for="peso">Peso (g)</label>
      <input type="number" id="peso" name="peso" [(ngModel)]="amount" placeholder="ex: 120">
      <label for="carboidratos">Carboidratos</label>
      <input type="number" id="carboidratos" name="carboidratos" [(ngModel)]="carbohydrate" placeholder="ex: 28.6">
      <label for="proteinas">Proteínas</label>
      <input type="number" id="proteinas" name="proteinas" [(ngModel)]="protein" placeholder="ex: 21">
      <label for="gorduras">Gorduras</label>
      <input type="number" id="gorduras" name="gorduras" [(ngModel)]="fat" placeholder="ex: 2.6">
      <button class="my-3 btn" (click)="addNewFood()">Adicionar</button>
    </div>
  </p-dialog>
</div>

<div class="flex flex justify-content-center mb-4">
  <button class="btn" (click)="showDialog()">Nova Refeição</button>
</div>

<div class="master-container">
  <div class="table-container" *ngFor="let table of foodTables$ | async, let i = index">
    <div class="flex justify-content-between align-items-center gap-2">
      <h3 class="title">{{table.name}}</h3>
      <div class="table-btns">
        <button class="pi pi-pencil icon-btn"></button>
        <button class="pi pi-trash icon-btn" (click)="deleteTable(table.id!)"></button>
      </div>
    </div>
    <div class="add-btn">
      <button (click)="showNewFoodDialog(table.id!)">Novo Alimento</button>
    </div>
    <ng-container *ngIf="foods && foods.length > 0">
      <div class="meals" *ngFor="let food of getFoodsForTable(table.id!)">
        <div>
          <span>{{food.name}}</span>
          <div>
            <span>{{food.amount}} g</span>
          </div>
        </div>
        <div style="text-align: end;" class="macro-master">
          <span>{{food.calories}} calorias</span>
          <div class="macronutrients-box">
            <span>C:{{food.carbohydrates}}</span>
            <span>P:{{food.proteins}}</span>
            <span>G:{{food.fats}}</span>
          </div>
        </div>
      </div>
    </ng-container>
  </div>
</div>
